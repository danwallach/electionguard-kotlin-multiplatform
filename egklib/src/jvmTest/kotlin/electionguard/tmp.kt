package electionguard

import io.mockk.InternalPlatformDsl.toStr
import kotlinx.serialization.encodeToString
import kotlinx.serialization.json.Json
import org.junit.jupiter.api.Test
import java.math.BigInteger

class BigIntTest {
    @Test
    fun testBigInteger() {
        val b1 = BigInteger("1EBC1E9BCC5FB0D9AC8E88F3914483403929656924518C36C596AB14A1BE8A9E", 16)
        val b2 = BigInteger("7BE7222D305B814AC0FDA6DE3E4A352D66BC41CF4BEFB166436B63A66D82418D", 16)
        val b3 = BigInteger("1a17149f0a34d268c22aca4c28a49d4891", 16)

        println(Json.encodeToString(b1.toByteArray()))
        println((b1 + b2).toString())
        println((b1 - b2).toString())
        println((b1 * b2).toString())
        println((b2 / b1).toString())
        println((b1 shl 3).toString())
        println((b1 shr 3).toString())
        println(b1.and(b2).toString())
        println(b1.or(b2).toString())
        println(b1.mod(b3).toString())
        println(b1.modInverse(b3).toString())
        println(b1.modPow(b2, b3).toString())

    }

    @Test
    fun testValidResidue() {
        val elem = BigInteger("116992134406449773249234693689874839485427227414454295298407421987294769420153177" +
                "155760253836121946105664657846448570170819379040912224738338572937636355180694982625128993355125324" +
                "166808528111381181056416536045878413100473903658989508633642904915269412650375183602531963198769196" +
                "896903129762045341743592634169240129961056739120801053845664293084690218777300267856690294627039272" +
                "384943963922025594960092984046367087013311517106183073444293556328996867007081230185476794115416870" +
                "996095078480338385987660126453217969071943569297150416034645148961310920694658563896591104840823904" +
                "700700530698502093252225574417521150587792985176720831408923890584908104659892288802557112366084521" +
                "255912502127488580103419655409233327515190806819515551652416220917513300146133246924706893222961649" +
                "772077571041632067286173657911633467147144563553932245311413099554305798795339359178556939882358148" +
                "7130514134993936559743552818386343308110330964625851")

        val q = BigInteger("115792089237316195423570985008687907853269984665640564039457584007913129639747")
        val p = BigInteger("580960599536995806285950253330457437068697517636289523666148615228720373099709483009" +
                "164679990011813639424024254149927553707850485773920009497041511114411097337730528801135335527786634" +
                "918169432165428312841058903334176304104137929381747458144648490999170130920673773131855045235344473" +
                "968219297574317643528067739612852338340634240996885523947295260556955377830976583385598780078783761" +
                "761381888485636457871455286553868494877316886831832441145315048660504021687022620773560787419686089" +
                "368253054598435086894361592053423266247872534313794016923288725056052844110961667212714340118578300" +
                "630335175288364400012055376512082795015479949849882020497254309974751946550717016525104882587723386" +
                "755556186065657779752773837583009129998429536249720903958484772139025076966885649997333756357307492" +
                "347677104682697329194739275955801755264407014895086026408047776771908998394304825334195885671794515" +
                "4145008143116288082670838568334769513317214978047")

        println(elem.modPow(q, p))

        val elemBar = electionguard.core.BigInteger(elem)
        val qBar = electionguard.core.BigInteger(q)
        val pBar = electionguard.core.BigInteger(p)

        println(elem.modPow(q, p))
    }
}